/* reset */
* { font-family: inherit; line-height: inherit; font-synthesis: none; }
a, abbr, acronym, address, applet, article, aside, audio, b, big, blockquote,
body, canvas, caption, center, cite, code, dd, del, details, dfn, div, dl, dt,
em, embed, fieldset, figcaption, figure, footer, form, grid, h1, h2, h3, h4, h5,
h6, header, hgroup, hr, html, i, iframe, img, ins, kbd, label, legend, li, main,
mark, menu, nav, noscript, object, ol, output, p, pre, q, s, samp, section,
small, span, strike, strong, sub, summary, sup, table, tbody, td, tfoot, th,
thead, time, tr, tt, u, ul, var, video {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
}
blockquote, q { quotes: none; }
blockquote:before, blockquote:after, q:before, q:after {
  content: "";
  content: none;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
a, a:active, a:visited { color: inherit; }
/* end of reset */

:root {
  --toolbarHeight: 32px;
  --messageHeight: 48px;
  --menuWidth: 160px;
  --colorFeedback: #f5f5f5;
  --colorSelected: #e9e9e9;
  --printMessageWidth: 450px;
}

body {
  background: transparent;
  color: #222;
  overflow: hidden;

  &.windowWidthSmall {
    --printMessageWidth: 250px;
  }
  &.windowWidthMedium {
    --printMessageWidth: 450px;
  }
  &.windowWidthLarge {
    --printMessageWidth: 650px;
  }
}
body, .sansSerif {
  font: 12px/16px 'Inter', system-ui, -system-ui, sans-serif;
  font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1;
}
@supports (font-variation-settings: normal) {
  body, .sansSerif { font-family: 'Inter var', system-ui, sans-serif; }
}

b, strong { font-weight:600 }
em, i { font-style:italic }

code, pre, textarea.code, tt, .monospace, .monaco-editor {
  font-family: iaw-quattro-var, iaw-quattro, monospace;
  font-feature-settings: 'calt' 1, 'kern' 1, 'liga' 1, 'ss04' 1;
  /*
    ss01: single-storey a
    ss02: double-storey g
    ss03: zero with slash (instead of dotted zero)
    ss04: zero without decoration (simple open zero)
  */
}
pre { white-space:pre-wrap }
code { white-space:nowrap }
code b, pre b, tt b { font-weight:540 }


#progress-spinner {}


@keyframes button-flash {
  0%   { background: lightgreen; }
  100% {  }
}


.button {
  flex: 0 0 auto;
  display: block;
  width: var(--toolbarHeight);
  height: var(--toolbarHeight);
  line-height: var(--toolbarHeight);
  text-align: center;
  cursor: default;
  user-select: none;
  opacity: 0.8;
  /*transition: background 200ms ease-out;*/
  background-position: center center;
  background-repeat: no-repeat;

  &:hover { opacity:1; background-color: #eee; }
  &:active { opacity:1; background-color: #ccc; }
  &.flash { animation: button-flash 200ms 1; }
}


#toolbar {
  position: absolute;
  left: 0; right:0; bottom: 0;
  height: var(--toolbarHeight);
  background: #eee;
  color: #333;
  z-index:3;
  display: flex;
  /*justify-content: space-between;*/
  border-bottom-left-radius: 2px; /* match figma dialog corner radius */
  border-bottom-right-radius: 2px; /* match figma dialog corner radius */

  & .button {
    &:hover { opacity:1; background-color: #ddd; }
    &:active { opacity:1; background-color: #aaa; }
    &:first-child { border-bottom-left-radius:2px; } /* fit figma window */
    &:last-child { border-bottom-right-radius:2px; } /* fit figma window */
    &.menu { background-image: url('./icon-menu.svg'); }
    &.menu.on {
      opacity:1;
      background-color: #ddd;
      &:hover { background-color: #ccc; }
      &:active { background-color: #bbb; }
    }
    &.run { background-image: url('./icon-play.svg'); }
    &.run.running { background-image: url("./icon-stop.svg"); }
    &.clear { background-image: url('./icon-clear.svg'); }
    &.unavailable {
      opacity:0.4;
      &:hover { background-color: inherit; }
    }
  }

  & .runqueue {
    flex: 1 1 auto;
    display: flex;
    justify-content: center;
    min-width: var(--toolbarHeight);
    height: var(--toolbarHeight);
    line-height: var(--toolbarHeight);
    font-size: 11px;
    user-select: none;
    pointer-events: none;
    overflow: hidden;

    & > div {
      width: var(--toolbarHeight);
      height: var(--toolbarHeight);
      text-align: center;
      transition: all 100ms ease-in;
      transition-property: transform, opacity;
      transform-origin: 50% 50%;
      background-position: 0 0;
      background-repeat: no-repeat;

      visibility:hidden;
      &.visible { visibility:visible; }

      &.pending { background-image: url("./icon-clock.svg"); opacity:0.3; }
      &.ok { background-image: url("./icon-success.svg"); }
      &.err { background-image: url("./icon-error.svg"); }
      &.hide {
        /*min-width: 0px;
        width: 0;*/
        transform: translate(0, calc(var(--toolbarHeight) / 2));
        opacity: 0;
      }
    }
  }
} /* #toolbar */



#menu {
  --menuItemHeight: 24px;

  position: absolute;
  left:0;
  top:0;
  bottom: 0;

  background: #fff;
  border-right: 1px solid #ddd;
  z-index: 3;
  width: var(--menuWidth);
  flex: 0 0 auto;
  outline: none;
  font-size: 11px;
  letter-spacing: 0.005em;
  padding-bottom: var(--menuItemHeight);

  overflow: auto;

  flex-direction:column;
  display:none;
  &.visible { display:flex; }

  & * { font-size: inherit; }

  & .button {
    border-radius: 2px;
    width:var(--menuItemHeight);
    height:var(--menuItemHeight);
    margin: 8px 8px 0 10px;

    &.new {
      background-image: url("./icon-add.svg");
    }
  }

  & h3 {
    padding: 0 16px;
    margin-top: 16px;
    height: var(--menuItemHeight);
    line-height: var(--menuItemHeight);
    font-weight: inherit;
    color: #bbb;
    user-select: none;
    cursor: default;
  }

  & ul {
    list-style:none;

    & li {
      display: flex;
      height: var(--menuItemHeight);
      /*background:lightpink;*/
      display:flex;
      align-items:center;
      padding: 0 4px 0 16px;
      user-select: none;
      cursor: default;
      color: #444;
      font-weight:500;

      &:hover { background: var(--colorFeedback); }
      &.active { background: var(--colorSelected); }
      &.unsaved {
        & span {
          font-style:italic;
        }
      }

      & .name {
        flex: 1 1 auto;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      & input[type="text"] {
        flex: 1 1 auto;
        font: inherit;
        letter-spacing: inherit;
        margin:0 8px 0 -4px;
        padding: 0 1px 0 4px;
        border: none;
        background: white;
        border-radius: 2px;
        outline: none;
        height: 20px;
      }

      & .button {
        --inlineButtonBorder: 1px;
        --inlineButtonSize: calc(18px - calc(var(--inlineButtonBorder) * 2));
        display:flex;
        justify-content:center;
        flex: 0 0 auto;
        margin: 0;
        width: var(--inlineButtonSize);
        height: var(--inlineButtonSize);
        line-height: var(--inlineButtonSize);
        border-radius: 100%;
        font-size: 8px;
        border: var(--inlineButtonBorder) solid rgba(0,0,0,0.4);
        color: black;
        opacity: 0.2;
        font-weight:600;

        visibility: hidden; /* shown on hover over sidebar */

        &:hover {
          border-color: black;
          background-color: inherit;
          opacity: 0.8;
        }
      }
    }
  }

  & > .section {
    height: var(--menuItemHeight);
    font-weight:600;
    display:flex;
    align-items:center;
    justify-content: space-between;
    padding-left:2px;
    user-select: none;
  }

  & hr {
    height:1px;
    border:none;
    background:rgba(0,0,0,0.1);
    margin: 8px;
  }

  &:hover ul .button {
    visibility: visible;
  }

  & .settings {
    display: flex;
    flex-direction: column;
    padding: 0 8px 0 16px;
    user-select: none;

    & label {
      display: block;
      height: var(--menuItemHeight);
      cursor: default;
      display:flex;
      align-items:center;

      & input[type="checkbox"] {
        margin-right: 6px;
        margin-left: 0;
      }

      & select[name="config.windowSize"] {
        flex: 1 1 auto;
        margin-left: 8px;
      }
    }
  }
} /* #menu */


#main {
  display: flex;
  position: absolute;
  left: 0; top: 0; right:0; bottom: var(--toolbarHeight);
  & > * {
    flex: 1 1 auto;
  }
}


#editor {
  position: absolute;
  left: 0; top: 0; right:0; bottom: 0;
  /* for blur effect */
  /*overflow:hidden;*/
}

body.menuVisible #editor {
  left: var(--menuWidth);
}


#message {
  position: absolute;
  left: 0; right:0; bottom: var(--toolbarHeight);
  height: var(--messageHeight);
  background: #FFF866;
  color: black;
  box-shadow: 0 -1px 2px rgba(50,20,0,0.1), 0 -0.5px 0 rgba(0,0,0,0.1);
  z-index:4;
  font-size:11px;
  align-items: center;
  overflow: hidden;
  /*display: flex;*/
  display: none;
}
#message .message {
  flex: 1 1 auto;
  align-items: center;
  max-height: var(--messageHeight);
  overflow: auto;
}
#message .message > p {
  padding: 8px 0;
}
#message div.warning-icon, #message div.close-button {
  flex: 0 0 auto;
  height: var(--messageHeight);
  line-height: var(--messageHeight);
  width: calc(var(--messageHeight) * 0.75);
  text-align: center;
  font-size: 16px;
  cursor: default;
  user-select: none; -webkit-user-select: none; -moz-user-select: none;
}
#message div.close-button { opacity: 0.4 }
#message div.close-button:hover { opacity: 1 }

/*#message > p::before {
  content: "âš  ";
  font-size: 16px;
  vertical-align: top;
}*/
body.showMessage #message { display: flex }
body.showMessage #editor { bottom: var(--messageHeight); }



.monaco-editor {
  font-feature-settings: 'calt' 1, 'kern' 1, 'liga' 1, 'ss04' 1;

  /*& .invisible scrollbar vertical fade*/
  /*& .visible.scrollbar vertical */
  & .scrollbar {
    & .slider {
      border-radius:5px;
    }
  }

  &.scripter-light .margin {
    & .line-numbers {
      color: #ccc;
    }
    & .current-line ~ .line-numbers {
      color: #888;
    }
  }

  & .detected-link {
    /*text-decoration: underline rgba(0, 0, 200, 0.1);*/
    text-decoration: none; /* TODO: support opening links */
  }
}

/*body.menuVisible .monaco-editor {
  -webkit-filter: url('#blur');
  filter: url('#blur');
  -webkit-filter: blur(5px);
  filter: blur(5px);
}*/

/*.monaco-editor .editor-scrollable {
  margin:8px 0;
}*/

/*@supports (font-variation-settings: normal)*/
/* Figma desktop app uses a really old version of chromium lacking vf support */
.monaco-editor.scripter-light .mtk16 { font-weight: 600; font-weight: 520 } /*keyword*/
.monaco-editor.scripter-light .mtk29 { font-weight: 440 } /*type.identifier*/

/* decorate runtime error */
.monaco-editor .runtimeErrorDecoration {
  background: url("./squiggly-line.svg") repeat-x bottom left;
  background-color: rgba(255, 240, 0, 0.2);
}

.monaco-editor .printDecoration {
  background-color: rgba(0, 200, 255, 0.1);
}

.monaco-editor .printWidget {
  z-index: 99;
  /*width: 500px;*/
  overflow: auto;

  /*box-sizing: border-box;
  border: 0.5em solid white;
  padding: 0.5em;
  border-radius: 13px;
  background-color: rgba(0, 0, 0, 0.1);*/

  /*border-left: 4px solid lightgreen;
  padding-left: 1em;
  background: #eeffee;*/

  & img {
    object-position: 50% 50%;
    object-fit: contain;
    object-fit: scale-down;
    object-fit: contain;
    max-width: 100%;
  }
}

.monaco-editor .printWidget > div {
  background: lightpink;
  display: flex;
  align-items: flex-start;
  height: 100%;
  width: var(--printMessageWidth);

  border-left: 4px solid lightgreen;
  padding-left: 0.5em;
  margin-right: 2em;
  background: #eeffee;
}

body.menuVisible .monaco-editor .printWidget > div {
  width: calc(var(--printMessageWidth) - var(--menuWidth));
}

.monaco-editor .printWidget > div .message {
  flex: 1 1 auto;
  white-space: pre-wrap;
  user-select: all;
  overflow: auto;
}

.monaco-editor .printWidget > div .button {
  cursor: default;
  /*padding: 0.5em 0.125em;*/
  /*margin: 0 0.125em;*/
  width:14px;
  height:14px;
  text-align: center;
  line-height:14px;
  font-size:12px;
  flex: 0 0 auto;
  opacity:0.5;
  user-select: none;
  pointer-events: all;
  /*background: transparent;*/
  /*background: rgba(0,0,0,0);*/
  /*background: black;*/
  color: black;
  border: 1px solid rgba(0,0,0,0);
  border-radius: 2px;
  font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1, 'case' 1;

  /*padding:1px;*/
  margin:1px;
}
/*.monaco-editor .printWidget > div .button:last-child {
  margin-right: 0.0;
  padding-right: 0.5em;
}*/
.monaco-editor .printWidget > div .button:hover {
  opacity:0.99;
  border-color: black;
  /*background: rgba(0,0,0,0.1);*/
}
.monaco-editor .printWidget > div .button.closeButton {}
.monaco-editor .printWidget.empty > div .button.inlineButton {}

/*.monaco-editor .printWidget.small > div .button {
  padding:1px;
  margin:0 1px 0 0;
}*/
